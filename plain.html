
<!DOCTYPE html>
<html lang="en">
<head>
	<title>Salud  | IOHealth</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="IOHealth." />
	<meta name="author" content="Nimbeo">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="shortcut icon" href="http://iohealth.nimbeo.com/favicon.png" type="image/x-icon" />
	<link rel="icon" href="http://iohealth.nimbeo.com/favicon.png" type="image/x-icon" />
	
		<!--[if IE 7]><link media="all" type="text/css" rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome-ie7.min.css">
<![endif]-->
	<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/default_start/plugins/bootstrap/css/bootstrap-7eadf08f2291f29584476fa3e8a733a3.css" />
<link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/default_start/plugins/bootstrap-daterangepicker/daterangepicker-bs3-7eadf08f2291f29584476fa3e8a733a3.css" />	<!--[if lt IE 9]><script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<script src="http://iohealth.nimbeo.com/builds/IE8_HTML5/plugins/html5shiv-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/IE8_HTML5/plugins/respond.min-7eadf08f2291f29584476fa3e8a733a3.js"></script><![endif]-->

	
			
	
		<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery-ui-1.10.3.custom-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/dropzone-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/fullcalendar-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/chosen-94ec3065c424d83d05fa0a1e0bbcadb7.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery.cleditor-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery.noty-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/noty_theme_default-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/elfinder.min-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/elfinder.theme-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/uploadify-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery.gritter-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/glyphicons-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/halflings-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/xcharts.min-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery.easy-pie-chart-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/jquery-jvectormap-1.2.2-81d8ff0a37203f5ebe3e24e1c669d591.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/style-e8dd5f21cb3b61bc5ecc2ff03711e5c6.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/css/nv.d3.min-81d8ff0a37203f5ebe3e24e1c669d591.css" />	<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/default_coolreport/css/coolreport_default-9efb121d76df3ccd954a3a92b4e8747b.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/default_coolreport/css/coolreport_common-f2c1acdb6840ddfd5eedae264fcae56f.css" />
<link rel="stylesheet" type="text/css" href="http://iohealth.nimbeo.com/builds/default_coolreport/css/coolreport_manager-9efb121d76df3ccd954a3a92b4e8747b.css" />	
	
    <link rel="stylesheet" type="text/css" href="css/custom.css" />	
			
	<script>
		var crHooks = [];
	</script>
    
    
    
</head>
<body class="">
						<header id="cr-navbar" class="navbar cr-navbar">
	<div class="container">
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".sidebar-nav.nav-collapse">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
		<a id="main-menu-toggle" class="hidden-xs open"><i class="icon-reorder"></i> <span class="inh_nobold">Menú</span></a>
		<a class="navbar-brand col-lg-2 col-sm-1 col-xs-12" href="http://iohealth.nimbeo.com" style="background: #FFFFFF !important">
			<span>
				<img src="http://iohealth.nimbeo.com/img/logo.png" alt="IOHealth" class="visible-md visible-lg" />
				<img src="http://iohealth.nimbeo.com/img/logo-small.png" alt="IOHealth" class="visible-xs visible-sm" />
			</span>
		</a>
		
				<div class="nav-no-collapse header-nav">
			<ul class="nav navbar-nav reportrange" style="position:relative">
				
													<li>
												<div id="reportrange" class="pull-right" style="width:100%">
							<a href="javascript:void(0)" class="btn" title="Filter">
								<i class="icon-filter icon-large"></i> <span><i class="icon-spinner icon-spin"></i></span>
							</a>
						</div>
					</li>
												
			</ul>
			<ul class="nav navbar-nav pull-right">
				
													<li class="dropdown">
			
						<div class="search-open">
							<div class="input-append">
								<form action="javascript:void(0)" class="form-search" id="form-search" name="form-search" style="display:inline-block">
									<div id="search-extendible">
										<input type="text" name="q" class="search" autocomplete="off" placeholder="Find reports in map..." />

										<ul class="dropdown-menu searchlist" role="menu" aria-labelledby="search"></ul>
									</div>
								</form>
							</div>
						</div>
						
						<a href="javascript:void(0)" class="btn search-box-opener" title="Search"><i class="icon-search search-btn"></i></a>
					</li>
												
								<li class="dropdown">
					<a class="btn account dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">
						<div class="avatar"></div>
						<div class="user">
							<span class="hello">Bienvenido</span>
							<span class="name">Jos&eacute; Antonio</span>
						</div>
					</a>
					<ul class="dropdown-menu">
						<li><a href="http://iohealth.nimbeo.com/profile"><i class="icon-cog"></i> Mis preferencias</a></li>
						<li><a href="http://iohealth.nimbeo.com/profile/49"><i class="icon-user"></i> Perfil público</a></li>
						<li><a href="http://iohealth.nimbeo.com/auth/logout"><i class="icon-off"></i> Salir</a></li>
					</ul>
				</li>
								
			</ul>
			
		</div>
		
	</div>	
</header>


<style type="text/css" style="display: none">
	.reportrange {
		position:relative;
		left:10%;
	}

	.reportrange span {
			font-size: 10px !important;	
	}

	@media (min-width: 992px) {
	  .reportrange {
	  		position:relative;
			left:50%;
		}
		.reportrange span {
			font-size: 14px !important;	
		}	
	}

</style>				
	<!--=== Content Part ===-->
	<div class="container">

		<div class="row">
	
							<div id="sidebar-left" class="col-lg-2 col-sm-1">

		
	<div class="nav-collapse sidebar-nav collapse navbar-collapse bs-navbar-collapse">
				<ul class="nav nav-tabs nav-stacked main-menu">
			
						<li>
				<a href="http://iohealth.nimbeo.com/report/770"><i class="icon-user icon-large"></i><span class="hidden-sm"> Perfil</span></a>
			</li>

			
			<li>
				<a href="http://iohealth.nimbeo.com/report?template=37"><i class="icon-adjust icon-large"></i><span class="hidden-sm"> Oxigeno en sangre</span></a>
			</li>
			<li>
				<a href="http://iohealth.nimbeo.com/report?template=28"><i class="icon-heart icon-large"></i><span class="hidden-sm"> Presión arterial</span></a>
			</li>
			<li>
				<a href="http://iohealth.nimbeo.com/report?template=27"><i class="icon-inbox icon-large"></i><span class="hidden-sm"> Peso</span></a>
			</li>
			<li>
				<a href="http://iohealth.nimbeo.com/report?template=25"><i class="icon-tint icon-large"></i><span class="hidden-sm"> Glucosa</span></a>
			</li>

			<!-- <li>
				<a href="http://iohealth.nimbeo.com/profile/report">
					<span class="hidden-sm">
  						<i class="icon-file-text-alt icon-large" ></i>
  						<i class="icon-star" style="position: absolute; top: 0.5em; left: 1.7em;"></i>  	
					</span>
					<span class="visible-sm">
  						<i class="icon-file-text-alt icon-large" style="margin-left: 0.4em;"></i>
  						<i class="icon-star" style="position: relative; top: -0.5em; left: -1.0em;"></i> 	
					</span>
					<span class="hidden-sm"> Mis informes<span class="label">1</span></span>
				</a>
			</li> -->
			

			<!--  <li class="">
					<a href="http://iohealth.nimbeo.com/rank"><i class="icon-trophy icon-large"></i><span class="hidden-sm"> Ranking</span></a>
			</li> -->

			<li><hr /></li>
			<li class="active">
					<a href="http://iohealth.nimbeo.com/health"><i class="icon-heart icon-large"></i><span class="hidden-sm"> Salud</span></a>
			</li>
			

						
						
						
						
						
						<!--
			<li>
				<a href="http://iohealth.nimbeo.com/setting"><i class="icon-wrench"></i><span class="hidden-sm"> Configuración</span></a>
			</li>
			-->
			<li><hr /></li>
		</ul>
	</div>
	
	
	<footer class="clearfix visible-sm inh_small inh_nopadding">
		<p class="text-center text-muted">
			IOHealth &copy; 2017.
		</p>
		<p class="text-center inh_small">
			<a href="http://iohealth.nimbeo.com/about" class="grey-hover">Acerca de</a><br />
			<a href="http://iohealth.nimbeo.com/contact" class="grey-hover">Contacto</a><br />
			<a href="http://iohealth.nimbeo.com/terms" class="grey-hover">Acuerdo de uso</a><br />
			<a href="http://iohealth.nimbeo.com/product" class="grey-hover">Producto</a>
		</p>
	</footer>
	<footer class="clearfix hidden-sm hidden-xs inh_nopadding">
		<p class="text-center text-muted">
			IOHealth &copy; 2017.
		</p>
		<p class="text-center inh_small">
			<a href="http://iohealth.nimbeo.com/about" class="grey-hover">Acerca de</a> -
			<a href="http://iohealth.nimbeo.com/contact" class="grey-hover">Contacto</a> -
			<a href="http://iohealth.nimbeo.com/terms" class="grey-hover">Acuerdo de uso</a> -
			<a href="http://iohealth.nimbeo.com/product" class="grey-hover">Producto</a>
		</p>
	</footer>
	
</div>
						
			<!-- start: Content -->
			<div id="content" class="col-lg-10 col-sm-11  ">
			
												
									
	<!--=== Content Part ===-->
	<div class="container">
	
		<div class="row">	
			<div class="col-lg-12">
				<div class="box">
					<div class="box-header">
						<h2><i class="icon-tasks"></i> Dashboards </h2>
						<div class="box-icon">
							<button id="refresh" class="btn background" style="padding: 0px;"><i class="icon-refresh backgroundColor backColor"></i></button>
						</div>
					</div>
					
					<div class="box-content">
						<div class="row">
							<form class="form-horizontal col-lg-12 col-sm-12" enctype="multipart/form-data">
								
								<fieldset class="col-lg-12 col-sm-12" >
									
									<div class="form-group">
										<label class="control-label" for="select-person">Personas <i class="icon-spinner icon-spin" style="display:none"></i></label>
										<div class="controls">
											<select id="select-person" name="person" class="form-control" data-rel="chosen" data-placeholder="Choose a Person ...">
												<option></option>
																									<option value="676">3</option>
																									<option value="682">5</option>
																									<option value="673">a</option>
																									<option value="677">cuatro</option>
																									<option value="731">j</option>
																									<option value="729">Javier</option>
																									<option value="730">Javier_1</option>
																									<option value="605">Jesus</option>
																									<option value="770">José Antonio</option>
																									<option value="17">Juan</option>
																									<option value="741">Laura</option>
																									<option value="742">Laura</option>
																									<option value="736">Maria</option>
																									<option value="738">Maria</option>
																									<option value="739">Maria</option>
																									<option value="740">Maria</option>
																									<option value="737">María</option>
																									<option value="691">Mario Andrés</option>
																									<option value="647">new</option>
																									<option value="743">Pedro</option>
																									<option value="749">Pedro</option>
																									<option value="748">Pedro</option>
																									<option value="747">Pedro</option>
																									<option value="746">Pedro</option>
																									<option value="745">Pedro</option>
																									<option value="716">Rafa</option>
																									<option value="607">Ruben</option>
																									<option value="722">test</option>
																									<option value="648">test</option>
																									<option value="723">test2</option>
																									<option value="724">test4</option>
																							</select>
										</div>
									</div>
								</fieldset>
							</form>
						</div>


						<ul class="nav nav-tabs" id="tab">
							<li class="active">
								<a data-toggle="tab" href="#actual">Actual</a>
							</li>
							<li> 
								<a data-toggle="tab" href="#history">History</a>
							</li>
						</ul>
					</div>
					
					<div class="tab-content" id="tabContent" style="padding: 0px !important">
						<!--  History  -->
						<div class="box-content tab-pane active" id="actual">
							
							<div class="row">
								<div class="col-xs-12">
									<div class="box margin-top-20">
										<div class="box-header level-2">
											<h2><i class="icon-bar-chart"></i> Registro </h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
										<div class="box-content">
											<div class="col-lg-3 col-sm-6">
												<div id="gBPD" class="sz1"></div>
											</div><!--/col-->
											<div class="col-lg-3 col-sm-6">
												<div id="gBPS" class="sz1"></div>
											</div><!--/col-->

											<div class="col-lg-3 col-sm-6">
												<div id="gSo2" class="sz1"></div>												
											</div><!--/col-->

											<div class="col-lg-3 col-sm-6">
												<div id="gW" class="sz1"></div>	
											</div><!--/col-->
										</div>
										<div class="row"></div>
									</div>
								</div>
							</div><!--/row-->

							<div class="row">
								<div class="col-xs-12">
									<div class="box margin-top-20">
										<div class="box-header level-2">
											<h2><i class="icon-bar-chart"></i> Estado </h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
										<div class="box-content">
											<div id="personState" class="col-lg-12"></div>
										</div>
										<div class="row"></div>
									</div>
								</div>
							</div><!--/row-->

							<div class="row">
								<div class="col-xs-12">
									<div class="box">
										<div class="box-header level-2">
											<h2><i class="icon-bolt"></i><span class="break"></span>Informacion del usuario</h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
									
										<div class="box-content">
											<div class="col-lg-6">
												<br>
												<h2 class="inh_bold">Nombre</h2>
												<dl id="personName" class="dl-horizontal inh_nomargin-top"></dl>
												<br>
												<h2 class="inh_bold">Genero</h2>
												<dl id="personGender" class="dl-horizontal inh_nomargin-top"></dl>
												<br>
												<h2 class="inh_bold">Fecha de nacimiento</h2>
												<dl id="PersonBirth" class="dl-horizontal inh_nomargin-top"></dl>
											</div>
											<div class="col-lg-6">
												<br>
												<h2 class="inh_bold">Apellidos</h2>
												<dl id="personSurname" class="dl-horizontal inh_nomargin-top"></dl>
												<br>
												<h2 class="inh_bold">Altura</h2>
												<dl id="personHeigth" class="dl-horizontal inh_nomargin-top"></dl>
												<br>
												<h2 class="inh_bold">Edad</h2>
												<dl id="personAge" class="dl-horizontal inh_nomargin-top"></dl>
											</div>
											<span class="clearfix"></span>
											

										</div>		
									</div>					
								</div>
							</div><!--/row-->
						</div>

						<div class="box-content tab-pane" id="history">

							<div class="row">

								<form class="form-horizontal col-lg-12 col-sm-12" enctype="multipart/form-data">

									<fieldset class="col-lg-12 col-sm-12">
										
										<div class="form-group "">
										  	<label class="control-label" for="dates">Date</label>
										  	<div class="controls row">
												<div class="input-group col-sm-11">
													<span class="input-group-addon"><i class="icon-calendar"></i></span>
																										<input type="text" class="form-control" id="dates" value="29/11/2017 - 30/11/2017">
	 											</div>
										  	</div>
										</div>

									</fieldset>
								
								</form>
							</div>

							<div class="row">
								<div class="btn-group type-selection col-lg-11" style="margin:0px 25px">
								  <button data-id="weight" type="button" class="btn active col-lg-4">Peso</button>
								  <button data-id="spo2" type="button" class="btn col-lg-4">Oxigeno en sangre</button>
								  <button data-id="bp" type="button" class="btn col-lg-4">Presion arterial</button>
								</div>
							</div>
								

							<div class="row">

								<div class="col-xs-12">
			
									<div class="box margin-top-20">
										<div class="box-header level-2">
											<h2><i class="icon-bar-chart"></i> Registros </h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
										<div class="box-content">
											<div class="row">
												<div id='linechart'>
													<svg style="height: 500px"> </svg>
												</div>
											</div>
										</div>
									</div>
									<!-- <div class="box margin-top-20">
										<div class="box-header level-2">
											<h2><i class="icon-bar-chart"></i> Oxigeno en sangre </h2>
										</div>
										<div class="box-content">
											<div class="row">
												<div id='linechart-spo2'>
													<svg style="height: 450px"> </svg>
												</div>
											</div>
										</div>
									</div>
									<div class="box margin-top-20">
										<div class="box-header level-2">
											<h2><i class="icon-bar-chart"></i> Presión arterial </h2>
										</div>
										<div class="box-content">
											<div class="row">
												<div id='linechart-bp'>
													<svg style="height: 450px"> </svg>
												</div>
											</div>
										</div>
									</div> -->
								</div>
							</div><!--/row-->
							<div class="row">
								<div class="col-xs-12">
									<div class="box">
										<div class="box-header level-2">
											<h2><i class="icon-bolt"></i><span class="break"></span>Tabla de detalle</h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
									
										<div class="box-content">
											<table id="datatable" class="table table-condensed bootstrap-datatable vertical-middle table-linked">
												<thead>
													<tr>
														<th></th>
														<th></th>
														<th></th>
														<th></th>
													</tr>
												</thead>
	   											<tbody></tbody>
											</table>
										</div>		
									</div>					
								</div>
							</div><!--/row-->
							<div class="row">
								<div class="col-xs-12">
									<div class="box">
										<div class="box-header level-2">
											<h2><i class="icon-globe"></i><span class="break"></span>Last alerts</h2>
											<div class="box-icon">
												<a href="javascript:void(0)" class="btn background btn-minimize" style="padding: 0px;"><i class="icon-chevron-up backgroundColor backColor"></i></a>
											</div>
										</div>
									
										<div class="box-content">
											<h1>Timeline</h1>
											<div class="graph">
												<div class="timeline"></div>
											</div>
										</div>		
									</div>					
								</div>
							</div><!--/row-->	
						</div>

					</div>
				</div>
			</div>	
		</div><!--/col-->
	</div><!--/col-->
	
	<!--=== End Content Part ===-->

<style type="text/css" style="display: none">
	.nvd3.multiChart .y2.axis .nv-axis line {
		stroke: none;
		fill: none;
	}
	.nvd3.multiChart .y1.axis .nv-axis line {
		opacity: 0.2;
	}
	.year-neighbor, .year-neighbor2 {
		/* Por si interesase en un futuro para eliminar el selector de años en el calendario
		visibility: hidden !important;
		*/
	}
	.prev, .next {
		/* Por si interesase en un futuro para eliminar el selector de años en el calendario
		display: none;
		*/
	}	
	.btn-group button{
	    background-color: #8fcc00;
	}
	.btn-group  button.btn.active{
	    background-color: #c2ff33;
	}

	#gritter-notice-wrapper {
	    width: 600px;
	}
	.gritter-title {
	    text-shadow: 0px 0px 0 #000;
	}

	.gritter-item{
	    background-color: rgba(221, 42, 42, 0.66);
	    color: white;
	    font-size: 15px;
	}
</style>

			
			</div>
			<!-- end: Content -->
			
		</div><!--/row-->
		
	</div>
	<!--=== End Content Part ===-->
	

		<script>
	var $SITE_PATH = "http://iohealth.nimbeo.com/",
		$SITE_NAME = "IOHealth",
		$REPORT_URL = "http://iohealth.nimbeo.com/report/",
		$UPLD_MAX_SIZE = "102400", // KB
		$enable_signup = "",
		$AUTH = "1",
		$MARKER_TYPES = {
			'default': 'flecha.png',
			'report': 'flecha_report.png',
			'attachment': 'flecha_attachment.png'
		};
	</script>
	
			<script>
		var $USER = {
				id: "49",
				firstname: "Jos&eacute; Antonio",
				surname: "Garc&iacute;a D&iacute;az",
				url: "http://iohealth.nimbeo.com/profile/49-jos-eacute-antonio-garc-iacute-a-d-iacute-az"
			};
		</script>
		
	
		<!--[if !IE]> --><script>window.jQuery || document.write("<script src='http://iohealth.nimbeo.com/manager_tpl/js/jquery-2.0.3.min.js'>"+"<"+"/script>");</script><!-- <![endif]-->
	<!--[if IE]><script>window.jQuery || document.write("<script src='http://iohealth.nimbeo.com/plugins/jquery-1.10.2.min.js'>"+"<"+"/script>");</script><![endif]-->
	<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="http://iohealth.nimbeo.com/manager_tpl/js/excanvas.min.js"></script><![endif]-->
	<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery-ui-1.10.3.custom.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery-migrate-1.2.1.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/bootstrap.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.ui.touch-punch.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.knob.modified.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.sparkline.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/d3.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/xcharts.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.inputlimiter.1.3.1.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.dataTables.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/dataTables.bootstrap.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.cookie.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.noty.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/dropzone.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/fullcalendar.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.chosen.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.flot.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.flot.pie.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.flot.stack.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.flot.resize.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.flot.time.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.autosize.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.placeholder.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery-jvectormap-1.2.2.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery-jvectormap-es-mill-en-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/jquery.gritter.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/nv.d3.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/custom-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/core-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/plugins/jquery.h5validate-dca7f9585080cc57bcf73b9a2ffe5ed0.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/uncompressed/justgage-dca7f9585080cc57bcf73b9a2ffe5ed0.js"></script>
<script src="http://iohealth.nimbeo.com/builds/manager_template/manager_tpl/js/raphael-2.1.4.min-81d8ff0a37203f5ebe3e24e1c669d591.js"></script>	<script src="http://iohealth.nimbeo.com/builds/mustache/plugins/mustache-a66cb8f1a82667fd07775501e27e93ab.js"></script>
<script src="http://iohealth.nimbeo.com/builds/mustache/plugins/handlebars-a66cb8f1a82667fd07775501e27e93ab.js"></script>
<script src="http://iohealth.nimbeo.com/builds/mustache/plugins/hb_helpers-a66cb8f1a82667fd07775501e27e93ab.js"></script>	
	
		<script src="http://iohealth.nimbeo.com/builds/default_coolreport/manager_tpl/js/bootstrap-datepicker.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/manager_tpl/js/bootstrap-timepicker.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/manager_tpl/js/bootstrap-colorpicker.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/bootstrap-daterangepicker/moment.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/bootstrap-daterangepicker/daterangepicker-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/jquery-json/jquery.json-2.4.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/manager_tpl/js/jquery.autosize.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/manager_tpl/js/jquery.placeholder.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/window-resizer-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/coolreport-4ee175e8b0e3a01b552d6d6cba856756.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/forms-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/statistic-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/location-picker-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/libs/manager-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/search-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/langs/en-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/generic-table-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/phpjs-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/js/script-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/bootbox/js/bootbox.min-f2c1acdb6840ddfd5eedae264fcae56f.js"></script>
<script src="https://maps.google.com/maps/api/js?key=AIzaSyDiKcVl7bPPwq5nUTL0X_GJoPrlltb3_7M&libraries=visualization&language=en"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/gmap/gmap-afa8b54ae91bf85b475ba76a11903ec3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/default_coolreport/plugins/gmap/markerclusterer-afa8b54ae91bf85b475ba76a11903ec3.js"></script>	
	
		<!-- Basset could not find collection: cr_calendar --><!-- Basset could not find collection: cr_calendar --><script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/topojson-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/three.min-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/d3-threeD2-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/OrbitControls-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/dat.gui.min-7eadf08f2291f29584476fa3e8a733a3.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/gis-b818b2663d066acff7a179ce02fbb83a.js"></script>
<script src="http://iohealth.nimbeo.com/builds/cr_maps/plugins/cr_maps/gis3d-7eadf08f2291f29584476fa3e8a733a3.js"></script>	
	
		<script>
$(document).ready(function(){
	crHooks.push(function(){
		
		// Actualizar el tamaño de algunos elementos a la ventana
		$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		  	$(window).trigger('resize');
		});

		setInterval(function(){ if ($('#select-person').val()) { viewPersonData(false);} }, 10000);
		$('#refresh').on('click', function(){ if ($('#select-person').val()) { viewPersonData();} } );
		
		/* jQuery Chosen */
		// Funcion para llamar al chosen cuando tiene muchos valores, actualiza los valores mediante peticiones ajax
		// Se necesita una ruta a la que llamar para obtener los datos
		// la ruta devuelve los datos y un count que se pasa por a la ruta para saber la ultima peticion
		function setChosen(selectDiv, url, call){

			var select = $('#'+selectDiv);

			$(select).chosen({ width: '100%', no_results_text: "<i class='icon-spinner icon-spin'></i> Searching " }).on('change', function(e) {
		    
			    call();
		  	});

			var chosen = $(select).siblings('.chosen-container');
		  	var count = 0;
		  	var input =  $(chosen).find('input:text');

			$(input).on('keyup', function(e) {
				var search = $(input).val();
				count++;
				$.get(url, {search: search, count: count})
					.success(function(data){
						if (count == data['count']) {
							$(select).empty();
							$(select).append(new Option());
							for(i=0; i<data['data'].length; i++)
		        			{		
								$(select).append(new Option(data['data'][i].id_real, data['data'][i].id));
							}
							
							$(select).trigger("chosen:updated");
							$(input).val(search);

							if(data['data'].length == 0){
								$(select).next().find(".chosen-results").append('<li class="no-results">No result match "' + (search) + '"</li>');
							}
							
						}
					});
			});
		}

		// funcion para generar el date picker
		function setDateRangePicker(div, call){
			$('#'+div).daterangepicker({
				format: 'DD/MM/YYYY',
				ranges: {
				   'Today': [moment(), moment()],
				   'Yesterday': [moment().subtract('days', 1), moment().subtract('days', 1)],
				   'Last 7 Days': [moment().subtract('days', 6), moment()],
				   'Last 30 Days': [moment().subtract('days', 29), moment()],
				   'This Month': [moment().startOf('month'), moment().endOf('month')],
				   'Last Month': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
				},
				startDate: moment().subtract('days', 1),
				endDate: moment()
			}, function(from, to) {

				self.from = from;
				self.to = to;
				
				call();

			});
		}

		
		
		// Funcion para generar la grafica de lineas
		/*
			lineData: [{
						'key': _label, 
						'color' : _color, 
						'values' : [{ 'x': _valorX, 'y': _valorY }, ..... ] },
						'type' : _tipo ( 'line', 'bar', ...),
						'yAxis' : _numEjeY}
					, ....]
		*/
		function setLineChart(div, lineData , unit, unit2, byDay = true ){

			nv.addGraph(function() {
			  var chart = nv.models.multiChart()
			  	.margin({top: 30, right: 75, bottom: 100, left: 85})
			  	.useInteractiveGuideline(true);
			  	//.color(d3.scale.category10().range());

			  chart.xAxis.tickFormat(function(d) {
			              return d3.time.format(byDay ? '%d/%m/%Y' : '%d/%m/%Y %I %p')(new Date(d))
			             });
			  chart.yAxis1.tickFormat(function(d) { return d3.format(',.0f')(d) + ' ' + unit});
			  chart.yAxis2.tickFormat(function(d) { return d3.format(',.0f')(d) + ' ' + unit2});
			  //chart.yAxis2.tickFormat(function(d) { return d3.format(',.1f')(d) + ' º'});

			  for(var line in lineData){
			  	// Convertir los datos a numeros
			  	lineData[line].values.forEach(function(d) { d.y = +d.y; });

				// Ordenar datos 
			  	lineData[line].values.sort(function (a, b){
			  		if (a.x > b.x) {
		 		   		return 1;
	  				}
		  			if (a.x < b.x) {
		    			return -1;
		  			}
		  					// a must be equal to b
		  			return 0;
			  	})
			  }

			  d3.select('#'+div+' svg')
				  .datum(lineData)
				  .transition().duration(500).call(chart);


			  $('#'+div+' svg g.nv-x text').attr('transform', 'translate(45,45) rotate(45)');
				  
			  
			  nv.utils.windowResize(function() { 
			  	  chart.update();
				  $('#'+div+' svg g.nv-x text').attr('transform', 'translate(45,45) rotate(45)');
			  });

			  	chart.legend.dispatch.on('legendClick', function() {
			  		setTimeout( function(){
				  		$('#'+div+' svg g.nv-x text').attr('transform', 'translate(45,45) rotate(45)');
			  		}, 1)
				});


			  $('.nvtooltip').css('opacity',0); // Esconder los tooltip que se habian generado si se ha actualizado la grafica
			  
			  return chart;
		    });
		}

		// Funcion para generar la tabla de datos
		function setDatatable(div, data, columns){
			// $("#"+div).dataTable().fnDestroy();
			$("#"+div).dataTable().fnClearTable();

			var thead = '';
			for (var i in columns) { thead += '<tr></tr>' }

			$("#"+div+' thead').html(thead);

			$('#'+div).dataTable({
				"bDestroy": true,
				"paging": true,
				'columns': columns,
				'data': data
			});
		}
		
		// funcion para generar el div de geolocalizacion
		/*
			data : obtenidos de la funcion TemplateBuilder::with(template->fields)->answer(datum)->readonly()->build() del report
		*/
		function setGeoData(geolocationDiv, geoinfoDiv, locationDiv, mapDiv, data) {
			// GEOLOCATION INFORMATION
			
			$("#"+geolocationDiv).attr('style','');

			var country = data.country ? data.country : '';
			var city = data.city ? data.city : '';
			var address = data.address ? data.address : '';

			var geoinfo = 	"<dl id='"+geoinfoDiv+"' class='dl-horizontal inh_nomargin-top'>"+
									"<br>"+
									"<dt>Country</dt><dd>"+ country +"</dd>"+
									"<dt>City</dt><dd>"+ city+"</dd>"+
									"<dt>Address</dt><dd>" + address + "</dd>"+
									"<br />";
			if(data.geo.type == 'Point'){
				geoinfo = geoinfo + "<dt>Latitude</dt><dd>" + data.geo.coordinates[1] + "</dd>";
				geoinfo = geoinfo + "<dt>Longitude</dt><dd>" + data.geo.coordinates[0] + "</dd>";
			}
			geoinfo = geoinfo +	"</dl>";	

			$('#'+geoinfoDiv).replaceWith(geoinfo);

			var location  = "<h2 id='"+locationDiv+"' class='inh_bold'>Location <a href='http://iohealth.nimbeo.com/#"+ data.id + "' class='blue inh_small pull-right'><i class='icon-search'></i> View in a big map</a></h2>";
			$('#'+locationDiv).replaceWith(location);

			$('img.static-map').each(function(){
				var $this = $(this),
					id = $this.data('id'),
					latitude = $this.data('latitude'),
					longitude = $this.data('longitude');

				// Relleno mapa del report
				url = GMaps.staticMapURL({
					size: [1000, 200],
					lat: latitude,
					lng: longitude,
					zoom: 16,
					scale: 2,
					markers: [
						{lat: latitude, lng: longitude, color: 'blue'}
					]
				});

				$this.attr('src', url);
			});
			// Relleno mapa del report
			var canvas = $('#'+mapDiv), dimensions = { width: canvas.width(), height: canvas.height() };
			
			var map = new google.maps.Map(document.getElementById(mapDiv), {
				center: new google.maps.LatLng(0,0),
				zoom: 1});
			
			var geojson = data.geo ;

			CoolReport.drawFromGeoJSON(map, geojson);
			CoolReport.zoomToGeoJSON(map, geojson);
			$('#'+mapDiv).height(450).width('auto'); 

			google.maps.event.trigger(map,'resize');
		}

		function setAlertTimeline( div, data ){

			$(div).html('');

			for( var i in data){
				var timeslot = 
					$('<div class="timeslot">'+
						'<div class="task">'+
							'<span style="background: #fffbf4; border: 2px solid #fd8f05; !important">'+
								'<span class="type">'+ data[i].title +'</span>'+
								'<span class="details">'+ data[i].description +'</span>'+
								'<span> Creado en:'+
									'<span class="remaining">'+ data[i].date +'</span>'+
								'</span>'+
							'</span>'+
							'</div>'+
							'<div class="icon" style="background: #fd8f05; border: #fd8f05; !important">'+
								'<i class="icon-bell" ></i>'+
							'</div>'+
						'<div class="time">'+ data[i].date +'</div>'+
					   '</div>');

				if (i%2 == 1) {
					$(timeslot).addClass('alt');
				}

				$(div).append(timeslot);
			}

			$(window).trigger('resize');


		}

		function getPersonDataValues( data, keys ){

			var values = [];

			for ( var key in keys ){
				values[keys[key]] = [];
			}

			for (var i in data ) {
				for ( var key in keys ){

					values[keys[key]].push({
						x: new Date (data[i]['fecha']),
						y: data[i][keys[key]]
					});
					// console.log(data[i][keys[key]], keys[key], data);
				}
			}
			return values;
		}

		var gBPD,gBPS,gSo2,gW;

		function initGages( age, gender, data, init = true ){

			var limits = {
				ages: [[16,18],[19,24],[25,29],[30,39],[40,49],[50,59],[60,Number.MAX_SAFE_INTEGER]],
				male:{
					sistolic: [[105,135],[105,139],[108,139],[110,145],[110,150],[115,155],[115,160]],
					diastolic: [[60,86],[62,88],[65,89],[68,92],[70,96],[70,98],[70,100]]
				}, 
				female:{
					sistolic: [[100,130],[100,130],[102,135],[105,139],[105,150],[110,155],[115,160]],
					diastolic: [[60,85],[60,85],[60,86],[65,89],[65,96],[70,98],[70,100]]
				}
			}

			var diastolic =['La tension diastólica es mas baja que la recomendada', 
						'La tension diastólica esta en los niveles recomendados',
						'La tension diastólica es mas alta que la recomendada'];
			var sistolic =['La tension sistólica es mas baja que la recomendada', 
						'La tension sistólica esta en los niveles recomendados',
						'La tension sistólica es mas alta que la recomendada'];
			var spo2 = ['El oxigeno en sangre es demasiado bajo', 
						'El oxigeno en sangre es muy bajo',
						'El oxigeno en sangre esta en niveles normales'];
			var imc = ['El peso esta por debajo del recomendado', 
						'El peso esta en valores recomendados',
						'El peso esta por encima del recomendado',
						'El peso esta demasiado alto, puede afectar a su salud. Se le recomienda perder peso'];

			
			var i = 0;
			for (i in limits.ages) {
				if (age <= limits.ages[i][1])
					break;
			}
			var g = (gender == 'Hombre') ? 'male' : 'female';

			var s,d,sis,i;
			if (data['spo2'] <= 80 ) {
				s= 0;
			}else if  (data['spo2'] <= 90 ){
				s = 1;
			}else{
				s = 2;
			}

			if (data['sistolic'] <= limits[g].sistolic[i][0] ) {
				sis = 0;
			}else if (data['sistolic'] >= limits[g].sistolic[i][1] ){
				sis = 2;
			}else{
				sis = 1;
			}

			if (data['diastolic'] <= limits[g].diastolic[i][0] ) {
				d = 0;
			}else if (data['diastolic'] >= limits[g].diastolic[i][1]  ){
				d = 2;
			}else{
				d = 1;
			}

			if (data['imc'] < 18.5 ) {
				i = 0;
			}else if (data['imc'] <= 25 ){
				i = 1;
			}else if (data['imc'] <= 30 ){
				i = 2;
			}else{
				i = 3;
			}

			if(init){
				$('#gBPD').html('');
				gBPD = new JustGage({
					id:"gBPD",
					value: (data['diastolic'] == null ? 0 : data['diastolic']),
					max: 120,
					min: 40,
					title:"Tension Diastólica",
					label: 'mmHg',
					customSectors: [{
				          	color : "#ff3b30",
				          	lo : 40,
				          	hi : (limits[g].diastolic[i][0] - 1)
				        },{
				          	color : "#57FB21",
				          	lo : limits[g].diastolic[i][0],
				          	hi : (limits[g].diastolic[i][1] - 1)
				        },{
				          	color : "#ff3b30",
				          	lo : limits[g].diastolic[i][1],
				          	hi : 120
				    }],
				});

				$('#gBPS').html('');
				gBPS = new JustGage({
					id:"gBPS",
					value: (data['sistolic'] == null ? 0 : data['sistolic']),
					max: 180,
					min: 80,
					title:"Tension Sistólica",
					label: 'mmHg',
					customSectors:[{
				          	color : "#ff3b30",
				          	lo : 80,
				          	hi : limits[g].sistolic[i][0]
				        },{
				          	color : "#57FB21",
				          	lo : limits[g].sistolic[i][0],
				          	hi : (limits[g].sistolic[i][1] - 1)
				        },{
				          	color : "#ff3b30",
				          	lo : limits[g].sistolic[i][1],
				          	hi : 180
				    }]
				});
					
				$('#gSo2').html('');
				gSo2 = new JustGage({
					id:"gSo2",
					value: (data['spo2'] == null ? 0 : data['spo2']),
					max: 100,
					min: 0,
					title:"Oxigeno en sangre",
					label: '%',
					customSectors:[{
				          	color : "#ff3b30",
				          	lo : 0,
				          	hi : 80
				        },{
				          	color : "#E1E14B",
				          	lo : 80,
				          	hi : 90
				        },{
				          	color : "#9ECA47",
				          	lo : 90,
				          	hi : 95
				        },{
				          	color : "#57FB21",
				          	lo : 95,
				          	hi : 100
			        }]
				});
			
				$('#gW').html('');
				gW = new JustGage({
					id:"gW",
					value: (data['imc'] == null ? 0 : data['imc']),
					max: 50,
					min: 10,
					title:"IMC",
					label:'Kg/m^2',
					customSectors: [{
				          	color : "#ff3b30",
				          	lo : 10,
				          	hi : 18.5
				        },{
				          	color : "#57FB21",
				          	lo : 18.5,
				          	hi : 24.99
				        },{
				          	color : "#ff3b30",
				          	lo : 25,
				          	hi : 50
			        }]
				});
			}else{
				gBPD.refresh(data['diastolic'] == null ? 0 : data['diastolic']);
				gBPS.refresh(data['sistolic'] == null ? 0 : data['sistolic']);
				gSo2.refresh(data['spo2'] == null ? 0 : data['spo2']);
				gW.refresh(data['imc'] == null ? 0 : data['imc']);
			}

			$('#gBPD,#gBPS,#gSo2,#gW').attr('data-toggle','tooltip');
			$('#gBPD').attr('title','<h5>'+diastolic[d]+'<h5>');
			$('#gBPS').attr('title','<h5>'+sistolic[sis]+'<h5>');
			$('#gSo2').attr('title','<h5>'+spo2[s]+'<h5>');
			$('#gW').attr('title','<h5>'+imc[i]+'<h5>');
		 	$('[data-toggle="tooltip"]').tooltip({
		    	html: "true", 
		    	placement: "auto-bottom"
		  	}); 

			console.log('gBPD',gBPD,'gBPS',gBPS,'gSo2',gSo2,'gW',gW);
		}

		function viewPersonData(init = true){

			console.log(init);

			$.get("personInfo", { person: $('#select-person').val() })
				.success(function(data){

					console.log('personInfo', data);

					$('#personName').text(data['info']['name']);
					$('#personSurname').text(data['info']['surname']);
					$('#personGender').text(data['info']['gender']);
					$('#personHeigth').text(data['info']['height']);
					$('#personAge').text(data['info']['age']);

					// var birth = new Date(data['birth']);
					var birth = null;

					if(data['info']['birth'].search(/-/) != -1)
						birth = moment(data['info']['birth'], "YYYY-MM-DD");
					else
						birth = moment(data['info']['birth'], "DD/MM/YYYY");

					$('#PersonBirth').text(birth.format("DD-MM-YYYY"));

					initGages(data['info']['age'], data['info']['gender'], data, init);

					$('#personState').html('');

					if(data['recomendaciones'] == null){
						$('#personState').html("<h2><b>No ha sido diagnosticado como paciente de ninguna enfermedad</b></h2>");

					}else{

						var state= '' ;
						for (var i in data['recomendaciones']) {
							$('#personState').append('<h2><b>Paciente con ' + i +'</b></h2>');

							for(var ii in data['recomendaciones'][i]['warning']){
								$('#personState').append('<p>' + data['recomendaciones'][i]['warning'][ii] +'</p>');
							}

							for(var ii in data['recomendaciones'][i]['critical']){
								$('#personState').append('<p><b>' + data['recomendaciones'][i]['critical'][ii] +'</b></p>');
							}
						}

					}

				})

	  		$.get("personsData", { person: $('#select-person').val(), startDate: $('#dates').data('daterangepicker').startDate.format("YYYY-MM-DD HH:mm:ssZ"), endDate: $('#dates').data('daterangepicker').endDate.clone().add('days', 1).format("YYYY-MM-DD HH:mm:ssZ")})
				.success(function(data){

					setPersonData(data, $(".type-selection button.active").attr('data-id'));

					// Selector de intervalo en gráficas
					$(".type-selection button").off("click").on("click", function() {
				    	if ($(this).siblings("button.active").length == 0) { //No ha cambiado de valor
				      		return;
						}

						//Actualizamos controles
				    	$(this).siblings().removeClass("active");
				    	$(this).addClass("active");

				    	setPersonData(data, $(this).attr('data-id'));

				    });
		    	})

			 $.get("personAlerts", { person: $('#select-person').val(), startDate: $('#dates').data('daterangepicker').startDate.format("YYYY-MM-DD HH:mm:ssZ"), endDate: $('#dates').data('daterangepicker').endDate.clone().add('days', 1).format("YYYY-MM-DD HH:mm:ssZ") })
				.success(function(data){

					setAlertTimeline('.timeline', data);
				})
		}

		function setPersonData(data, type){

			var data_attr = {
				bp :  {
					columns: ['sistolic', 'diastolic', 'pulse'],
					key: ['Sistólica','Diastólica','Pulso'],
					color: ['red','blue','green'],
					type: ['line','line','line'],
					yAxis: ['1','1','2'],
					disabled: [false,false,true],
					axis_labels:['mmHg','latidos/m']
				},
				spo2 :  {
					columns: ['spo2'],
					key: ['Oxigeno en sangre'],
					color: ['blue'],
					type: ['line'],
					yAxis: ['1'],
					disabled: [false],
					axis_labels:['%', '']
				},
				weight :  {
					columns: ['peso', 'imc'],
					key: ['Peso','IMC'],
					color: ['red','blue'],
					type: ['line','line'],
					yAxis: ['1','1'],
					disabled: [false,false],
					axis_labels: ['Kg', 'Kg/m^2']
				},
			}

			var data_values = getPersonDataValues(data[type], data_attr[type]['columns']);

			var lineData = [];
			var tableColumns = [{
				title: 'fecha', 
				className: 'text-center', 
				data: 'fecha'
			}];

			for (var i in data_attr[type]['key']) {
				lineData.push({
					key: data_attr[type]['key'][i],
					color: data_attr[type]['color'][i],
					values: data_values[data_attr[type]['columns'][i]],
					type: data_attr[type]['type'][i],
					yAxis: data_attr[type]['yAxis'][i],
					disabled: data_attr[type]['disabled'][i]
				});

				tableColumns.push({
					title: data_attr[type]['key'][i], 
					className: 'text-center', 
					data: data_attr[type]['columns'][i]
				})
			}

			setLineChart('linechart', lineData, data_attr[type]['axis_labels'][0], data_attr[type]['axis_labels'][1]);

			setDatatable("datatable", data[type], tableColumns);

			// var columns = [
			// 	{title: 'Fecha', className: 'text-center', data: 'timestamp'},
			// 	{title: 'Entradas (' + formatedMaxCTValue + ')', className: 'text-center', data: 'entradas'},
			// 	{title: 'Salidas (' + formatedMaxCTValue + ')', className: 'text-center', data: 'salidas'},
			// 	{title: 'eControl Cabecera (' + formatedMaxCTValue + ')', className: 'text-center', data: 'econtrol'},
			// 	{title: 'Suministros / eControl Frontera (' + formatedMaxCTValue + ')', className: 'text-center', data: 'datasuministros'},
			// 	{title: 'Pérdidas (%)', className: 'text-center', data: 'perdidas'}
			// ];
			// console.log(data[type]);

			// var bp = getPersonDataValues(data['bp'], ['sistolic', 'diastolic', 'pulse']);
			// var spo2 = getPersonDataValues(data['spo2'], ['spo2']);
			// var weight = getPersonDataValues(data['weight'], ['peso', 'imc']);

			// console.log(bp, spo2, weight);

			// lineDataBP = [];
			// lineDataSpo2 = [];
			// lineDataWeight = [];

			// lineDataBP.push({
			// 	'key': 'Sistólica',
			// 	'color': 'red',
			// 	'values': bp['sistolic'],
			// 	'type': 'line',
			// 	'yAxis': 1,
			// 	"disabled": false
			// });

			// lineDataBP.push({
			// 	'key': 'Diastólica',
			// 	'color': 'blue',
			// 	'values': bp['diastolic'],
			// 	'type': 'line',
			// 	'yAxis': 1,
			// 	"disabled": false
			// });

			// lineDataBP.push({
			// 	'key': 'Pulso',
			// 	'color': 'green',
			// 	'values': bp['pulse'],
			// 	'type': 'line',
			// 	'yAxis': 2,
			// 	"disabled": true
			// });
			// setLineChart('linechart-bp', lineDataBP, 'mmHg','latidos/m');

			// lineDataSpo2.push({
			// 	'key': 'Oxigeno en sangre',
			// 	'color': 'blue',
			// 	'values': spo2['spo2'],
			// 	'type': 'line',
			// 	'yAxis': 1,
			// 	"disabled": false
			// });
			// setLineChart('linechart-spo2', lineDataSpo2, '%');

			// lineDataWeight.push({
			// 	'key': 'Peso',
			// 	'color': 'red',
			// 	'values': weight['peso'],
			// 	'type': 'line',
			// 	'yAxis': 1,
			// 	"disabled": false
			// });

			// lineDataWeight.push({
			// 	'key': 'IMC',
			// 	'color': 'blue',
			// 	'values': weight['imc'],
			// 	'type': 'line',
			// 	'yAxis': 2,
			// 	"disabled": true
			// });
			// setLineChart('linechart-weight', lineDataWeight, 'Kg', 'Kg/m^2');
				
		}	

		// INIT
		setChosen('select-person','persons', viewPersonData);

		setDateRangePicker('dates',function(){

			if ($('#select-person').val()) {
				viewPersonData();
			}
		});

					$('#select-person').val(770);
			$('#select-person').trigger("chosen:updated");
			$('#select-person').change();
			$('#select-person').closest('.row').hide();
		
	})
	
});
</script>
	
	<script>
	$(document).ready(function()
	{
		for (var i = 0; i < crHooks.length; i++)
		{
			crHooks[i]();
		}
	});
	</script>
</body>
</html>
